; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino

; Set CPU Frequency to maximum for better stepper performance
board_build.f_cpu = 240000000L

; Enable PSRAM if available on your ESP32
board_build.partitions = huge_app.csv

; File system configuration
board_build.filesystem = littlefs
board_build.filesystem_size = 1m

; Library dependencies
lib_deps =
    ; MPU6050 IMU sensor
    adafruit/Adafruit MPU6050@^2.2.6

    ; Fast Stepper Motor Control
    gin66/FastAccelStepper@^0.31.3

    ; Web Server
    esphome/ESPAsyncWebServer-esphome@^3.3.0
    esphome/AsyncTCP-esphome@^2.1.4

    ; PID Controller
    br3ttb/PID @ ^1.2.1

    ; Additional useful libraries
    adafruit/Adafruit NeoPixel@^1.12.3
    bblanchon/ArduinoJson@^7.2.1

; Build flags
build_flags = 
    -DCORE_DEBUG_LEVEL=3  ; Enable detailed debug output
    -DASYNCWEBSERVER_REGEX=1  ; Enable regex support in web server
    -O2  ; Optimize for performance
    -DCONFIG_ARDUHAL_LOG_COLORS=1  ; Colored logging
    -DBOARD_HAS_PSRAM  ; Enable if using PSRAM
    -mfix-esp32-psram-cache-issue  ; Fix PSRAM cache issues

; Upload settings
upload_speed = 921600
upload_protocol = esptool

; Monitor settings
monitor_speed = 115200

; monitor_filters = 
;    esp32_exception_decoder
;    time
;    colorize

; Optional: Enable if using OTA updates
;upload_protocol = espota
;upload_port = 192.168.1.x  ; Replace with your ESP32's IP

; Additional monitor filters for better debugging
monitor_filters =
    esp32_exception_decoder
    time
    colorize
    log2file
    default